# エラー処理

エラー処理とは、プログラムが予期しないエラーに遭遇した際にも、安全に動作し続けるための仕組みです。

---

## エラー処理とは？

プログラムがエラーで突然停止しないよう、「予測されるエラーをキャッチし、適切に対処する」仕組みです。

---

## try-except（基本的な使い方）

例外が発生しそうな処理を `try` ブロックで囲み、発生した例外を `except` ブロックでキャッチします。

### 基本例

```python
try:
    num = int(input("数字を入力してください: "))
    print(10 / num)
except ValueError:
    print("数字を入力してください")
except ZeroDivisionError:
    print("0で割ることはできません")
```

* `ValueError` や `ZeroDivisionError` はエラーの種類（例外）を指定します。
* それぞれのエラーに対して、異なる処理を実行できます。

### 実行例（入力が数値以外の場合）

```
数字を入力してください: abc
数字を入力してください
```

### 実行例（0を入力した場合）

```
数字を入力してください: 0
0で割ることはできません
```

---

## finally（必ず実行される処理）

`finally` ブロックは、例外が発生しても、しなくても必ず実行されます。

### 使用例

```python
try:
    f = open("sample.txt")
    # ファイルの処理を行う
finally:
    f.close()  # 必ずファイルを閉じる
```

* ファイルの開閉やデータベース接続解除など、後処理を確実に実行したい場合に役立ちます。

---

## 実践課題（手を動かしてみよう！）

### 課題：安全な数値割り算プログラム

以下の手順でエラー処理を用いた簡単な割り算プログラムを作成しましょう。

#### 手順

1. 新しいファイルを作成し、`safe_division.py`という名前で保存します。
2. 以下のコードをファイルに記述します。

```python
try:
    a = int(input("割られる数を入力してください："))
    b = int(input("割る数を入力してください："))
    result = a / b
    print(f"計算結果：{result}")
except ValueError:
    print("数値を正しく入力してください。")
except ZeroDivisionError:
    print("0で割ることはできません。")
finally:
    print("計算終了")
```

3. ターミナルまたはコマンドプロンプトを開き、以下のコマンドでプログラムを実行します。

```bash
python safe_division.py
```

---

## よくある間違い・Q\&A

### エラーの種類を指定する

* `except` の後には、どのエラーを捕まえるのか指定します。

```python
# 正しい例
except ValueError:
    print("値のエラー")

# どんなエラーも捕まえる（推奨はされません）
except Exception as e:
    print(f"予期しないエラーが発生しました：{e}")
```

### エラーメッセージをよく読む

* エラーが発生した時は、エラーメッセージをよく読むと原因が分かりやすいです。

---

> エラー処理を使うことで、安心してプログラムを実行できるようになります！

[◀ 戻る：ファイル操作](python_basic_file.md)
